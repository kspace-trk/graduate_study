\chapter{先行研究}
現在，個人の感性を反映した自動作曲システムの研究が進められている．
本章では，大谷らの研究\cite{otani16}と白川の研究\cite{Shirakawa14}に基づく自動作曲システムについて概説する．

\section{楽曲の生成手順}
最初に，既存楽曲の中からユーザが楽曲を選択する．
選択した楽曲に共通する和音進行とメロディの特徴を感性モデルとして抽出し，
感性モデルをもとにテンプレート生成器からメロディテンプレート，和音進行生成器から和音進行を進化計算アルゴリズムを使用し生成する．メロディ
テンプレートと和音進行からメロディ生成器を用いて新たな楽曲を生成する．
楽曲の生成手順を図\ref{fig:make}に示す

\section{感性モデル}
先行研究では，メロディと和音進行に関する以下の4つの特徴を感性モデルとして抽出する．
\begin{itemize}
    \item メロディの音高変化
    \item メロディの発音タイミング
    \item 和音進行の和音名
    \item 和音進行の発音タイミング
\end{itemize}
ユーザが選択した楽曲を2小節からなるモチーフに分け，メロディの特徴を要素列として表現する．
メロディの音高変化は，先行音より音高が上がるup，音高が下がるdown，
音高が同じであるﬂatの3種類の要素の列で表現する．
メロディの発音タイミングは，音を鳴らさないnull，音を鳴らし始めるbeat，
先行音を延長して鳴らす-の3種類の要素の列で表現し，各要素は1/4拍分の音の状態を表す．
和音名は，根音，タイプ，テンション，オンコードの4つの要素列で構成され，
タイプ，テンション，オンコードに何も入らない場合は-とし，入っても入らなくても良い場合は999で表す．
和音進行の発音タイミングは音を鳴らし始めるbeatと，先行音を延長して鳴らす-の2種類の要素の列で表現する．

\begin{figure}[htb]
  \begin{center}
  \includegraphics[scale=0.5]{image/make.png}
  \caption{楽曲の生成手順}
  \label{fig:make}
  \end{center}
\end{figure}

\section{メロディの生成}
まず，抽出した感性モデルに適合するメロディテンプレートを生成する．
メロディテンプレートとは，メロディを構成する音の音高以外の情報を保持しており，
メロディの各音の鳴り始めるタイミングと鳴り続ける長さ，音高変化を表すものである．
生成するメロディの楽譜では，メロディテンプレートにおいて音を鳴らし始める状態を表しているとき
音符が配置される．メロディの各音高は，生成楽曲の調からメロディに使用可能な音高を要素とする
音高候補集合を用意する．和音が鳴り始めるタイミングで演奏される音の音高を決める際には，不協和音になる
音高は音高候補集合から削除する．

\section{問題点}
先行研究で生成される楽曲はピアノで演奏されることを想定している．
生成された和音進行をもとに伴奏部を作成する際に，和音進行を便宜的にそのまま演奏している．
そのまま演奏すると，同時和音を多用することになる．同時和音とは，和音の構成音を同時に演奏することである．同時和音を多用すると楽曲全体のリズム感が欠如する．楽曲に個人の感性が反映されていてもリズム感に欠け，印象が悪くなるという問題がある．

%\begin{figure}[h]
%  \centering
%  \includegraphics[width=7cm]{image/pre_melody.png}
%  \caption{生成されたメロディと和音進行の例}
%  \label{fig:pre_melody}
%\end{figure}

%\begin{figure}[h]
%  \centering
%  \includegraphics[width=7cm]{image/pre_piano.png}
%  \caption{生成されたメロディと伴奏部の例}
%  \label{fig:pre_piano}
%\end{figure}